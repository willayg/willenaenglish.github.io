<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google" content="notranslate">
  <meta http-equiv="Content-Language" content="en">
  <meta name="naver" content="notranslate">
  <meta name="robots" content="noindex,nofollow">
  <title>PresentGame1</title>
  <style>
    
body {
    
  font-family: 'Poppins', sans-serif;
  background: url('../../Assets/Images/backgrounds/twilightclouds.png') no-repeat center center fixed;
  background-size: cover;
  background-color: rgb(1, 6, 88);
  color: white;
  text-align: center;
  margin: 0;
  padding: 0;
}


    .container {
      max-width: 600px;
      margin: 80px auto;
      padding: 20px;
      border: 4px solid white;
      border-radius: 20px;
      background-color: rgba(0, 0, 0, 0.6);
    }
    #quizScreen, #endScreen {
      display: none;
    }
    button {
      font-size: 1.2em;
      padding: 10px 20px;
      background-color: #326ad3;
      color: white;
      border: none;
      border-radius: 10px;
      margin-top: 20px;
    }
    .options button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding-top: 16px;
      padding-bottom: 16px;
      font-size: 1.4em;
    }
    #logo {
      width: 100px;
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }
    #emoji {
      font-size: 6em;
      flex: 0 0 auto;
      text-align: center;
      margin: 0 auto;
    }
    .status-bar {
      display: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .status-item {
      font-size: 2em;
      font-weight: bold;
      width: 80px;
      text-align: center;
    }
#nameInput {
  display: block;
  margin: 20px auto;
  text-align: center;
}

.noselect {
  user-select: none;
}
#soundToggle {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 20;
  font-size: 2em;
  background: none;
  border: none;
  color: #388e3c;
  cursor: pointer;
  box-shadow: none;
  margin: 0;
  padding: 0;
}
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body translate="no">
<a href="../../playzone.html" class="notranslate">
  <img id="logo" src="../../Assets/Images/Logo.png" alt="Willena Logo">
</a>
<button id="soundToggle" title="Toggle Sound">ðŸ”Š</button>
  <div class="container">
    <div id="startScreen">
      <h1>Go or Goes</h1>
      <button onclick="startGame()">Start Game</button>
    </div>

    <div id="quizScreen">
      <div class="status-bar">
        <div class="status-item"><span id="timer">20</span>s</div>
        <div id="emoji"></div>
        <div class="status-item"><span id="score">0</span></div>
      </div>
      <div class="options" id="options"></div> <button id="restartButton" onclick="resetGame()" style="display: none; margin-top: 10px;">Restart</button>
    </div>

    <div id="endScreen">
      <h2>Game Over!</h2>
      <p>Your score: <span id="finalScore"></span></p>
      <p>Top Scores:</p>
      <ol id="highscores"></ol>
      <input type="text" id="nameInput" style="padding-top: 16px; padding-bottom: 16px;" placeholder="Enter your name">
      <button id="submitBtn">Submit Score</button>

      <button onclick="resetGame()">Play Again</button>
    </div>
  </div>
  

  <script>
window.game = "PresentGame1";

const questions = [
  {
    sentence: "He _____ the pizza.",
    answer: "eats",
    choices: ["eat", "eats"]
  },
  {
    sentence: "They _____ to school every day.",
    answer: "go",
    choices: ["go", "goes"]
  },
  {
    sentence: "She _____ English very well.",
    answer: "speaks",
    choices: ["speak", "speaks"]
  },
  {
    sentence: "I _____ up at 7 o'clock.",
    answer: "wake",
    choices: ["wake", "wakes"]
  },
  {
    sentence: "The dog _____ loudly.",
    answer: "barks",
    choices: ["bark", "barks"]
  },
  {
    sentence: "We _____ our homework after dinner.",
    answer: "do",
    choices: ["do", "does"]
  },
  {
    sentence: "My mom _____ coffee in the morning.",
    answer: "drinks",
    choices: ["drink", "drinks"]
  },
  {
    sentence: "You _____ very fast.",
    answer: "run",
    choices: ["run", "runs"]
  },
  {
    sentence: "It _____ a lot in spring.",
    answer: "rains",
    choices: ["rain", "rains"]
  },
  {
    sentence: "Tom _____ TV after school.",
    answer: "watches",
    choices: ["watch", "watches"]
  },
  {
    sentence: "The cat _____ on the sofa.",
    answer: "sleeps",
    choices: ["sleep", "sleeps"]
  },
  {
    sentence: "We _____ to music in the car.",
    answer: "listen",
    choices: ["listen", "listens"]
  },
  {
    sentence: "Anna _____ a sandwich for lunch.",
    answer: "eats",
    choices: ["eat", "eats"]
  },
  {
    sentence: "They _____ soccer on Saturdays.",
    answer: "play",
    choices: ["play", "plays"]
  },
  {
    sentence: "He _____ a red hat.",
    answer: "wears",
    choices: ["wear", "wears"]
  },
  {
    sentence: "I _____ my teeth twice a day.",
    answer: "brush",
    choices: ["brush", "brushes"]
  },
  {
    sentence: "She _____ her bike to school.",
    answer: "rides",
    choices: ["ride", "rides"]
  },
  {
    sentence: "The baby _____ when itâ€™s hungry.",
    answer: "cries",
    choices: ["cry", "cries"]
  },
  {
    sentence: "You _____ very well in class.",
    answer: "participate",
    choices: ["participate", "participates"]
  },
  {
    sentence: "Dad _____ the newspaper every morning.",
    answer: "reads",
    choices: ["read", "reads"]
  },
  {
    sentence: "My sister _____ her room every weekend.",
    answer: "cleans",
    choices: ["clean", "cleans"]
  },
  {
    sentence: "They _____ a big cake for the party.",
    answer: "make",
    choices: ["make", "makes"]
  },
  {
    sentence: "The sun _____ in the east.",
    answer: "rises",
    choices: ["rise", "rises"]
  },
  {
    sentence: "Birds _____ in the sky.",
    answer: "fly",
    choices: ["fly", "flies"]
  },
  {
    sentence: "We _____ books at the library.",
    answer: "borrow",
    choices: ["borrow", "borrows"]
  },
  {
    sentence: "He _____ new words every day.",
    answer: "learns",
    choices: ["learn", "learns"]
  },
  {
    sentence: "She _____ the violin beautifully.",
    answer: "plays",
    choices: ["play", "plays"]
  },
  {
    sentence: "I _____ my lunch at school.",
    answer: "eat",
    choices: ["eat", "eats"]
  },
  {
    sentence: "The teacher _____ us homework.",
    answer: "gives",
    choices: ["give", "gives"]
  },
  {
    sentence: "My dad _____ to work at 8 a.m.",
    answer: "goes",
    choices: ["go", "goes"]
  },
  {
    sentence: "Children _____ a lot of energy.",
    answer: "have",
    choices: ["have", "has"]
  },
  {
    sentence: "A bee _____ honey.",
    answer: "makes",
    choices: ["make", "makes"]
  },
  {
    sentence: "I _____ cartoons on weekends.",
    answer: "watch",
    choices: ["watch", "watches"]
  },
  {
    sentence: "She _____ her homework after dinner.",
    answer: "does",
    choices: ["do", "does"]
  },
  {
    sentence: "They _____ the bus to school.",
    answer: "take",
    choices: ["take", "takes"]
  },
  {
    sentence: "We _____ games on our phones.",
    answer: "play",
    choices: ["play", "plays"]
  },
  {
    sentence: "He _____ chocolate a lot.",
    answer: "likes",
    choices: ["like", "likes"]
  },
  {
    sentence: "She _____ to music when studying.",
    answer: "listens",
    choices: ["listen", "listens"]
  },
  {
    sentence: "I _____ my best friend every day.",
    answer: "call",
    choices: ["call", "calls"]
  },
  {
    sentence: "My grandma _____ great stories.",
    answer: "tells",
    choices: ["tell", "tells"]
  }
];


let score = 0;
let timer;
let timeLeft = 30;
let currentQuestion;
let usedQuestions = [];
const startScreen = document.getElementById('startScreen');
const quizScreen = document.getElementById('quizScreen');
const endScreen = document.getElementById('endScreen');
const emoji = document.getElementById('emoji');
const options = document.getElementById('options');
const timerDisplay = document.getElementById('timer');
const scoreDisplay = document.getElementById('score');
const finalScore = document.getElementById('finalScore');
const highscoresList = document.getElementById('highscores'); // Make sure this matches your HTML
const nameInput = document.getElementById('nameInput');

// Sound setup
const correctSound = new Audio('../../Assets/Audio/right.mp3');
const wrongSound = new Audio('../../Assets/Audio/wrong.mp3');
const endGameSound = new Audio('../../Assets/Audio/endgame.mp3');
const sneakingout = new Audio('../../Assets/Audio/sneakingout.mp3');
sneakingout.loop = true;
sneakingout.volume = 0.5;
let soundOn = true;
const soundToggle = document.getElementById('soundToggle');
soundToggle.onclick = function() {
  soundOn = !soundOn;
  correctSound.muted = !soundOn;
  wrongSound.muted = !soundOn;
  endGameSound.muted = !soundOn;
  sneakingout.muted = !soundOn;
  soundToggle.textContent = soundOn ? 'ðŸ”Š' : 'ðŸ”‡';
};
// Ensure all sounds respect the toggle at start
correctSound.muted = !soundOn;
wrongSound.muted = !soundOn;
endGameSound.muted = !soundOn;
sneakingout.muted = !soundOn;

const supabaseUrl = 'https://fiieuiktlsivwfgyivai.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZpaWV1aWt0bHNpdndmZ3lpdmFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2MTEyNTIsImV4cCI6MjA2NDE4NzI1Mn0.aMQN_U2aLvH7RzuT-dfzQF4RNA7YQ-Xn6upqJFr7eis';
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

function startGame() {
  score = 0;
  timeLeft = 30;
  endScreen.style.display = 'none';
  startScreen.style.display = 'none';
  if (sneakingout.paused) {
    sneakingout.currentTime = 0;
    sneakingout.play();
  }
  if (timer) clearInterval(timer);
  usedQuestions = [];
  quizScreen.style.display = 'block';
  document.getElementById('restartButton').style.display = 'inline-block';
  document.querySelector('.status-bar').style.display = 'flex';
  scoreDisplay.textContent = score;
  timerDisplay.textContent = timeLeft;
  nextQuestion();
  timer = setInterval(() => {
    timeLeft--;
    timerDisplay.textContent = timeLeft;
    if (timeLeft <= 0) {
      endGame();
    }
  }, 1000);
}

function nextQuestion() {
  if (usedQuestions.length === questions.length) {
    endGame();
    return;
  }
  let index;
  do {
    index = Math.floor(Math.random() * questions.length);
  } while (usedQuestions.includes(index));
  usedQuestions.push(index);
  currentQuestion = questions[index];
  displayQuestion();
}

function displayQuestion() {
  // Show the sentence with the blank
  options.innerHTML = '';
  document.getElementById('emoji').textContent = ''; // Clear emoji area if present
  const questionText = document.createElement('div');
  questionText.style.fontSize = '2em';
  questionText.style.margin = '30px 0';
  questionText.textContent = currentQuestion.sentence;
  // Insert question text above options
  const quizScreen = document.getElementById('quizScreen');
  // Remove any previous question text
  const prev = document.getElementById('questionText');
  if (prev) prev.remove();
  questionText.id = 'questionText';
  quizScreen.insertBefore(questionText, options);

  // Show the two options as buttons
  const shuffledChoices = [...currentQuestion.choices].sort(() => Math.random() - 0.5);
  shuffledChoices.forEach(choice => {
    const btn = document.createElement('button');
    btn.textContent = choice;
    btn.onclick = () => checkAnswer(choice);
    options.appendChild(btn);
  });
}

function checkAnswer(choice) {
  const buttons = document.querySelectorAll('#options button');
  buttons.forEach(btn => {
    btn.disabled = true;
    if (btn.textContent === currentQuestion.answer) {
      btn.style.backgroundColor = '#ffeb3b'; // bright yellow
      btn.style.color = '#000'; // black text
    } else if (btn.textContent === choice) {
      btn.style.backgroundColor = '#e53935'; // red
    }
  });
  if (choice === currentQuestion.answer) {
    correctSound.currentTime = 0;
    correctSound.play();
    score += 200;
    scoreDisplay.textContent = score;
    setTimeout(nextQuestion, 500);
  } else {
    wrongSound.currentTime = 0;
    wrongSound.play();
    score -= 100;
    scoreDisplay.textContent = score;
    setTimeout(nextQuestion, 500);
  }
}

function endGame() {
  document.getElementById('restartButton').style.display = 'none';
  clearInterval(timer);
  quizScreen.style.display = 'none';
  endScreen.style.display = 'block';
  finalScore.textContent = score;
  endGameSound.currentTime = 0;
  endGameSound.play();
  displayHighScores();

  // Check for logged-in user
  const loggedInName = localStorage.getItem('user_name') || sessionStorage.getItem('user_name');
  const submitBtn = document.getElementById('submitBtn');
  if (loggedInName) {
    nameInput.value = loggedInName;
    nameInput.style.display = 'none';
    if (submitBtn) submitBtn.style.display = 'none';
    submitScore(loggedInName); // auto-submit
  } else {
    nameInput.style.display = 'block';
    if (submitBtn) submitBtn.style.display = 'inline-block';
  }
}

async function submitScore(forcedName) {
  const name = forcedName || nameInput.value || 'Anonymous';
  console.log("Submit button clicked");

  const { data, error } = await supabase
    .from('Scores')
    .insert([{ name, score, game: window.game || 'PresentGame1' }]);
  if (error) {
    console.error('Failed to submit score:', error.message);
  } else {
    console.log('Score submitted:', data);
    nameInput.style.display = 'none';
    const submitBtn = document.getElementById('submitBtn');
    if (submitBtn) submitBtn.style.display = 'none';
    displayHighScores();
  }
}

async function displayHighScores() {
  const { data, error } = await supabase
    .from('Scores')
    .select('name, score')
    .eq('game', 'PresentGame1')
    .order('score', { ascending: false })
    .limit(5);

  if (error) {
    console.error('Failed to fetch scores:', error.message);
    return;
  }

  highscoresList.innerHTML = '';
  data.forEach(entry => {
    const li = document.createElement('li');
    li.textContent = `${entry.name}: ${entry.score}`;
    highscoresList.appendChild(li);
  });
}


function resetGame() {
  document.getElementById('restartButton').style.display = 'none';
  nameInput.value = '';
  scoreDisplay.textContent = '0';
  timerDisplay.textContent = '30';
  startScreen.style.display = 'block';
  quizScreen.style.display = 'none';
  endScreen.style.display = 'none';
  nameInput.style.display = 'block';
  const submitBtn = document.getElementById('submitBtn'); // FIXED
  if (submitBtn) submitBtn.style.display = 'inline-block'; // FIXED
  highscoresList.innerHTML = '';
}
document.addEventListener('DOMContentLoaded', () => {
  startScreen.style.display = 'block';
  quizScreen.style.display = 'none';
  endScreen.style.display = 'none';
  emoji.textContent = '';
  options.innerHTML = '';
  scoreDisplay.textContent = '0';
  timerDisplay.textContent = '30';
  nameInput.style.display = 'none';
  highscoresList.innerHTML = '';

  const submitBtn = document.getElementById('submitBtn');
  if (submitBtn) {
    submitBtn.style.display = 'none';
    submitBtn.addEventListener('click', submitScore);
  }
});

  </script>
</body>
</html>

